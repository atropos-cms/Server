type User {
    id: ID!
    first_name: String
    last_name: String
    initials: String
    street: String
    postcode: String
    city: String
    country: String
    email: String!
    created_at: DateTime!
    updated_at: DateTime!
    deleted_at: DateTime

    permissions: [Permission!]!  @method(name: "getAllPermissions")
    directPermissions: [Permission!]!  @method(name: "getDirectPermissions")
    inheritedPermissions: [Permission!]! @method(name: "getPermissionsViaRoles")
    roles: [Role!]!
}

input UpdateOrCreateUserInput {
    first_name: String
    last_name: String
    street: String
    postcode: String
    city: String
    country: String
    email: String
}

input UpdateUserPasswordInput {
    current_password: String
    password: String
    password_confirmation: String
}

extend type Query @middleware(checks: ["auth:api"]) {
    me: User @auth
    user(id: ID! @eq): User @find
    users(search: String @search, orderBy: [OrderByClause!] @orderBy): [User!]! @paginate @softDeletes
}

extend type Mutation @middleware(checks: ["auth:api"]) {
    updateMe(data: UpdateOrCreateUserInput! @spread): User @updateUserValidation
    updateMyPassword(data: UpdateUserPasswordInput! @spread): User @updateUserPasswordValidation

    createUser(data: UpdateOrCreateUserInput! @spread): User @updateUserValidation @create
    updateUser(id: ID!, data: UpdateOrCreateUserInput! @spread): User @updateUserValidation @update
    deleteUser(id: ID!): User @delete
    restoreUser(id: ID!): User @restore
}
